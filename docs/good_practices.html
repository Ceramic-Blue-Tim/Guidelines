

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Good practices &mdash; Guidelines 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Boards resources" href="resources.html" />
    <link rel="prev" title="Development tools" href="dev_tools.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Guidelines
          

          
            
            <img src="_static/CBT.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="repo_handling.html">Repository handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_tools.html">Development tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Good practices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#documentation">Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-publish-github-pages-from-documentation-repository">Simple publish Github Pages from documentation repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#matlab">Matlab</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#comments">Comments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#header">Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sections">Sections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inline">Inline</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#python">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vhdl">VHDL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#indent">Indent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Comments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Header</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ports">Ports</a></li>
<li class="toctree-l4"><a class="reference internal" href="#signal-declaration">Signal declaration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#think-generic">Think generic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#constants">Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="#make-packages">Make packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smart-signals-assignation-using-length">Smart signals assignation using ‘length</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Boards resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="bugs_report.html">Bugs report</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Guidelines</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Good practices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/good_practices.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="good-practices">
<h1>Good practices<a class="headerlink" href="#good-practices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simple-publish-github-pages-from-documentation-repository">
<h3>Simple publish Github Pages from documentation repository<a class="headerlink" href="#simple-publish-github-pages-from-documentation-repository" title="Permalink to this headline">¶</a></h3>
<p>Since Github only allows to serve static html from either /root or /docs of a given branch and
Sphinx outputs html under /build/html it is convenient to script documentation generation to
obtain a structure easily publishable using github pages.</p>
<p>One of the many solution is to organize the repository as below :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Git repo
├───docs
│   └───*.html
└───src
    └───docs
        ├───build
        ├───source
        ├───Makefile
        └───make.bat
</pre></div>
</div>
<ul class="simple">
<li><p><strong>src/docs</strong> is your local Sphinx folder with sources and build</p></li>
<li><p><strong>docs</strong> is html static content for github pages</p></li>
</ul>
<p>Then the Makefile is modified to generate Sphinx documentation and copy its output in docs folder.</p>
<div class="highlight-Makefile notranslate"><div class="highlight"><pre><span></span><span class="c"># Folder for html output</span>
<span class="nv">DOCS</span>          <span class="o">=</span> ../../docs

<span class="c"># Add new make file directive : make github</span>
<span class="nf">github</span><span class="o">:</span>
<span class="c">    # Clean build folder</span>
	rm -rf <span class="s2">&quot;</span><span class="k">$(</span>BUILDDIR<span class="k">)</span><span class="s2">&quot;</span>
<span class="c">    # Generate Sphinx documentation</span>
	make html
<span class="c">    # Remove previous html static content to allow copy</span>
	rm -rf <span class="s2">&quot;</span><span class="k">$(</span>DOCS<span class="k">)</span><span class="s2">&quot;</span>
<span class="c">    # Copy build in github pages source folder being /docs</span>
	mv <span class="s2">&quot;</span><span class="k">$(</span>BUILDDIR<span class="k">)</span><span class="s2">/html&quot;</span> <span class="s2">&quot;</span><span class="k">$(</span>DOCS<span class="k">)</span><span class="s2">&quot;</span>
<span class="c">    # Create .nojekyll file to setup github pages correctly</span>
	<span class="nb">echo</span> $ &gt;&gt; <span class="s2">&quot;</span><span class="k">$(</span>DOCS<span class="k">)</span><span class="s2">/.nojekyll&quot;</span>
</pre></div>
</div>
<p>Therefore, you can stick to <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code> to locally check changes in src/ then you may use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">github</span></code> and stage/push your changes.</p>
<p>You may also add the local build to the .gitignore.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ignore local build for sphinx doc</span>
<span class="n">docs</span><span class="o">/</span><span class="n">build</span><span class="o">/</span>
</pre></div>
</div>
<p><em>Better solutions use a different branch staging only static html content updated with Github Actions or git hooks. For the time being this solution is easier to set up and suits our needs.</em></p>
</div>
</div>
<div class="section" id="matlab">
<h2>Matlab<a class="headerlink" href="#matlab" title="Permalink to this headline">¶</a></h2>
<div class="section" id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<p>Comments also are essential. There are plenty of way to handle it since Matlab is widely use by people from non-programming background. Here are some rules I usually apply for my scripts.</p>
<div class="section" id="header">
<h4>Header<a class="headerlink" href="#header" title="Permalink to this headline">¶</a></h4>
<p>Adding a header at the beginning of all yours files. It will help you keeping track on your sources and defusing potential cases of plagiarism.
A header usually includes the name of the authors, the creation and update date and versioning as well as comments.</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w"></span>
<span class="c">%   Authors     : Romain BEAUBOIS</span><span class="w"></span>
<span class="c">%   Create Date : 06 Aug 2021</span><span class="w"></span>
<span class="c">%   Update Date : 09 Aug 2021</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Description : A simple header to illustrate</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Revision :</span><span class="w"></span>
<span class="c">%       &gt; Revision 0.01 - File created</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Additional Comments :</span><span class="w"></span>
<span class="c">%       &gt; Not much more to say, it&#39;s juste an example</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h4>
<p>Insert comments below functions is a standard, the | and ** are syntax used by Sphinx for documentation layout.</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>u<span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nf">ohmLaw</span><span class="p">(</span>r, i<span class="p">)</span><span class="w"></span>
<span class="c">% | **Compute ohm&#39;s law**</span><span class="w"></span>
<span class="c">% |</span><span class="w"></span>
<span class="c">% | **u** : Voltage (V)</span><span class="w"></span>
<span class="c">% | **r** : Resistance (ohm)</span><span class="w"></span>
<span class="c">% | **i** : Current (A)</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">% | Compute simple ohm&#39;s law from fixed parameters in SI unit</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="sections">
<h4>Sections<a class="headerlink" href="#sections" title="Permalink to this headline">¶</a></h4>
<p>Sections (comments blocks that start with %%) are usually followed by a consistent name.
They can be divided in blocks separated by simple line comment with a simple tab.</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">%% Define Parameters ##########################################################################</span><span class="w"></span>
<span class="w">    </span><span class="c">% Time</span><span class="w"></span>
<span class="w">        </span><span class="k">...</span><span class="w"></span>

<span class="w">    </span><span class="c">% Geometry</span><span class="w"></span>
<span class="w">        </span><span class="k">...</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="inline">
<h4>Inline<a class="headerlink" href="#inline" title="Permalink to this headline">¶</a></h4>
<p>Inline comments are mostly used for variables declaration or assignation so as they describe what si the variable for, what operation is performed or what is the unit.</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">dt</span><span class="w">              </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span>^<span class="o">-</span><span class="mi">5</span><span class="p">;</span><span class="w">     </span><span class="c">% ms - Time step</span><span class="w"></span>
<span class="w">    </span><span class="n">sim_time</span><span class="w">        </span><span class="p">=</span><span class="w"> </span><span class="mf">30e3</span><span class="p">;</span><span class="w">     </span><span class="c">% ms - Simulation time</span><span class="w"></span>

<span class="w">    </span><span class="n">neur_diam</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span><span class="w">       </span><span class="c">% µm - Average diameter of a neuron</span><span class="w"></span>
<span class="w">    </span><span class="n">dist_orgs</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="mi">120</span><span class="p">;</span><span class="w">      </span><span class="c">% µm - Distance between centers of organoids</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="python">
<h2>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h2>
<p>WIP</p>
</div>
<div class="section" id="vhdl">
<h2>VHDL<a class="headerlink" href="#vhdl" title="Permalink to this headline">¶</a></h2>
<div class="section" id="indent">
<h3>Indent<a class="headerlink" href="#indent" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id1">
<h3>Comments<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>VHDL is known to be a verbose language, meaning that it requires a lot of detailed syntax. Therefore, wisely and efficiently commenting is highly recommanded both for your own mental health and for code sharing.</p>
<div class="section" id="id2">
<h4>Header<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>As for the other languages, the file header states intellectual property and gives useful details on the file versioning. Here is a quick example.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="c1">-- ===============================================================================</span>
<span class="c1">--  Authors     : Romain BEAUBOIS</span>
<span class="c1">--  Create Date : 01 Jan 2021</span>
<span class="c1">--  Update Date : 23 Aug 2021</span>
<span class="c1">--</span>
<span class="c1">--  Description : Top module of SNN-SHH-MMN</span>
<span class="c1">--</span>
<span class="c1">--  Revision:</span>
<span class="c1">--      &gt; Revision 0.01 - File created</span>
<span class="c1">--      &gt; Revision 0.02 - Add fixed point representation</span>
<span class="c1">--</span>
<span class="c1">--  Additional Comments :</span>
<span class="c1">--      &gt; &quot;for loops&quot; of matrix larger than N=10 induces negative WNS (WIP)</span>
<span class="c1">-- ===============================================================================</span>
</pre></div>
</div>
</div>
<div class="section" id="ports">
<h4>Ports<a class="headerlink" href="#ports" title="Permalink to this headline">¶</a></h4>
<p>It is sometimes useful to organise properly the inputs and outputs of a module.
However, it may sometimes hamper column selection and incremental selection as your
lines are getting sparsed. Here is a quick example.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">port</span><span class="p">(</span>
    <span class="c1">-- Clock/reset --</span>
    <span class="n">clk</span>     <span class="o">:</span> <span class="k">in</span>  <span class="kt">std_logic</span><span class="p">;</span>
    <span class="n">reset</span>   <span class="o">:</span> <span class="k">in</span>  <span class="kt">std_logic</span><span class="p">;</span>

    <span class="c1">-- SPI --</span>
    <span class="n">DAC_sclk</span>    <span class="o">:</span> <span class="k">out</span> <span class="kt">std_logic</span><span class="p">;</span>
    <span class="n">DAC_cs</span>      <span class="o">:</span> <span class="k">out</span> <span class="kt">std_logic</span><span class="p">;</span>
    <span class="n">DAC_mosi</span>    <span class="o">:</span> <span class="k">out</span> <span class="kt">std_logic</span><span class="p">;</span>

    <span class="c1">-- PSU -&gt; FPGA via AXI LITE</span>
        <span class="c1">-- RAM control</span>
        <span class="n">PSU_en_write</span>    <span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic</span><span class="p">;</span>
        <span class="n">PSU_addrw</span>       <span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic_vector</span><span class="p">(</span><span class="n">ADDRSIZE</span><span class="o">-</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>

        <span class="c1">-- Conductance</span>
        <span class="n">PSU_GK</span>      <span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic_vector</span><span class="p">(</span><span class="n">INT</span><span class="o">+</span><span class="n">DEC</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="signal-declaration">
<h4>Signal declaration<a class="headerlink" href="#signal-declaration" title="Permalink to this headline">¶</a></h4>
<p>About the same principles apply to signal declaration. Try to regroup your signals according to their role or connecting module. Here is another example.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span>    <span class="c1">-- Clock --</span>
    <span class="k">signal</span> <span class="n">clk</span>              <span class="o">:</span> <span class="kt">std_logic</span><span class="p">;</span> <span class="c1">-- Main clock</span>

    <span class="c1">-- DSP pipelines</span>
    <span class="k">signal</span> <span class="n">A</span>    <span class="o">:</span> <span class="kt">signed</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="n">DEC</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span>    <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span> <span class="c1">-- DSP multiplier inputs</span>
    <span class="k">signal</span> <span class="n">B</span>    <span class="o">:</span> <span class="kt">signed</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="n">DEC</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span>    <span class="o">:=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span> <span class="c1">-- DSP multiplier inputs</span>

    <span class="c1">-- Time --</span>
    <span class="k">signal</span> <span class="n">tick</span>             <span class="o">:</span> <span class="kt">std_logic</span> <span class="o">:=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>                 <span class="c1">-- Computation enable</span>
    <span class="k">signal</span> <span class="n">tick_counter</span>     <span class="o">:</span> <span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">11</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>    <span class="c1">-- Counts clock cycle to generate ticks</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="think-generic">
<h3>Think generic<a class="headerlink" href="#think-generic" title="Permalink to this headline">¶</a></h3>
<p>Another important parameter is the genericity of your design. VHDL is interpreted by the software roughly as a huge list of components and connections. Therefore, using generic parameters instead of fixed parameters will facilitate the scalibity of your design and simplify development.</p>
<div class="section" id="constants">
<h4>Constants<a class="headerlink" href="#constants" title="Permalink to this headline">¶</a></h4>
<p>The use of constants in VHDL is really imporant, it helps generic generation and really clarify your code. Moreover, they do not relate to any material generation since they correpond to GND or VCC connections on pins (quite similar to the C preprocessor directive #define). Let’s take the example of a FPGA implementation to get the signal from 4 parallel ADC coded on 12 bits, a wise description could start with the following definitions.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span>    <span class="k">constant</span> <span class="n">NB_ADC</span>     <span class="o">:</span> <span class="kt">integer</span> <span class="k">range</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">4</span>      <span class="o">:=</span> <span class="mi">4</span><span class="p">;</span>       <span class="c1">-- Number of ADC to read</span>
    <span class="k">constant</span> <span class="n">NB_BIT_ADC</span> <span class="o">:</span> <span class="kt">integer</span> <span class="k">range</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">12</span>     <span class="o">:=</span> <span class="mi">12</span><span class="p">;</span>      <span class="c1">-- Number of bits for ADC signal encoding</span>
    <span class="k">type</span> <span class="n">data_ADC_s</span> <span class="k">is</span> <span class="k">array</span> <span class="p">(</span><span class="mi">0</span> <span class="k">to</span> <span class="n">NB_ADC</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">of</span> <span class="kt">std_logic_vector</span><span class="p">(</span><span class="n">NB_BIT_ADC</span><span class="o">-</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>    <span class="c1">-- Signal type for an array of ADC signals</span>
    <span class="k">signal</span> <span class="n">data_ADC</span>     <span class="o">:</span> <span class="n">data_ADC_s</span>                <span class="o">:=</span> <span class="p">(</span><span class="k">others</span><span class="o">=&gt;</span><span class="p">(</span><span class="k">others</span><span class="o">=&gt;</span><span class="sc">&#39;0&#39;</span><span class="p">));</span> <span class="c1">-- Signal for all ADC data</span>

    <span class="c1">-- data_ADC(0) is a 12 bits vector corresponding to the data of your first ADC</span>
</pre></div>
</div>
</div>
<div class="section" id="make-packages">
<h4>Make packages<a class="headerlink" href="#make-packages" title="Permalink to this headline">¶</a></h4>
<p>As well defined on <a class="reference external" href="https://www.nandland.com/vhdl/examples/example-package.html">nandland</a>, a package in VHDL is a collection of functions, procedures, shared variables, constants, files, aliases, types, subtypes, attributes, and components. It can roughly be seen as a library in C. Using packages, you will able to use custom types of signal or constants in all your module as long as your include the package. A good example of package is also given on <a class="reference external" href="https://www.nandland.com/vhdl/examples/example-package.html">nandland</a>.</p>
<ul class="simple">
<li><p>Package file description</p></li>
</ul>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Package Declaration Section</span>
<span class="k">package</span> <span class="n">example_package</span> <span class="k">is</span>
 
  <span class="k">constant</span> <span class="n">c_PIXELS</span> <span class="o">:</span> <span class="kt">integer</span> <span class="o">:=</span> <span class="mi">65536</span><span class="p">;</span>
 
  <span class="k">type</span> <span class="n">t_FROM_FIFO</span> <span class="k">is</span> <span class="k">record</span>
    <span class="n">wr_full</span>  <span class="o">:</span> <span class="kt">std_logic</span><span class="p">;</span>
    <span class="n">rd_empty</span> <span class="o">:</span> <span class="kt">std_logic</span><span class="p">;</span>
  <span class="k">end</span> <span class="k">record</span> <span class="nc">t_FROM_FIFO</span><span class="p">;</span>  
   
  <span class="k">component</span> <span class="nc">example_component</span> <span class="k">is</span>
    <span class="k">port</span> <span class="p">(</span>
      <span class="n">i_data</span>  <span class="o">:</span> <span class="k">in</span>  <span class="kt">std_logic</span><span class="p">;</span>
      <span class="n">o_rsult</span> <span class="o">:</span> <span class="k">out</span> <span class="kt">std_logic</span><span class="p">);</span> 
  <span class="k">end</span> <span class="k">component</span> <span class="nc">example_component</span><span class="p">;</span>
 
  <span class="k">function</span> <span class="n">Bitwise_AND</span> <span class="p">(</span>
    <span class="n">i_vector</span> <span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">3</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="kt">std_logic</span><span class="p">;</span>
   
<span class="k">end</span> <span class="k">package</span> <span class="nc">example_package</span><span class="p">;</span>
 
<span class="c1">-- Package Body Section</span>
<span class="k">package</span> <span class="k">body</span> <span class="n">example_package</span> <span class="k">is</span>
 
  <span class="k">function</span> <span class="n">Bitwise_AND</span> <span class="p">(</span>
    <span class="n">i_vector</span> <span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">3</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="kt">std_logic</span> <span class="k">is</span>
  <span class="k">begin</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">i_vector</span> <span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">and</span> <span class="n">i_vector</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">and</span> <span class="n">i_vector</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">and</span> <span class="n">i_vector</span> <span class="p">(</span><span class="mi">3</span><span class="p">));</span>
  <span class="k">end</span><span class="p">;</span>
 
<span class="k">end</span> <span class="k">package</span> <span class="k">body</span> <span class="nc">example_package</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Using package in modules</p></li>
</ul>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">library</span> <span class="nn">work</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">work.example_package.</span><span class="k">all</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="smart-signals-assignation-using-length">
<h4>Smart signals assignation using ‘length<a class="headerlink" href="#smart-signals-assignation-using-length" title="Permalink to this headline">¶</a></h4>
<p>Another step toward generic design comes with the use of generic signal assignation. A very useful properties of VHDL signal is the reference to their length that will help signal assignation and concatenation. Here are some applications.</p>
<ul class="simple">
<li><p>Assign a value using build-in functions</p></li>
</ul>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">signal</span> <span class="n">counter</span> <span class="o">:</span> <span class="kt">unsigned</span><span class="p">(</span><span class="mi">31</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">-- constants works well in that case too</span>
<span class="n">counter</span> <span class="o">&lt;=</span> <span class="n">to_unsigned</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">counter</span><span class="na">&#39;length</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Assign from a larger signal to smaller one (truncate)</p></li>
</ul>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="c1">-- let&#39;s assume we want to get a value from the axi registers that are 32 bits wide</span>
<span class="k">signal</span> <span class="n">axi_reg</span>  <span class="o">:</span> <span class="kt">unsigned</span><span class="p">(</span><span class="mi">31</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">signal</span> <span class="n">value</span>    <span class="o">:</span> <span class="kt">unsigned</span><span class="p">(</span><span class="mi">15</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">value</span>           <span class="o">&lt;=</span> <span class="n">axi_reg</span><span class="p">(</span><span class="n">value</span><span class="na">&#39;length</span><span class="o">-</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>  
<span class="c1">-- obviously valid only if your value stored in axi register is intended to be coded on 16 bits </span>
</pre></div>
</div>
<ul class="simple">
<li><p>Assign from a smaller signal to larger one (resize)</p></li>
</ul>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="c1">-- let&#39;s assume we want to write a 16 bits wide value in the 32 bits wide axi registers </span>
<span class="k">signal</span> <span class="n">axi_reg</span>  <span class="o">:</span> <span class="kt">unsigned</span><span class="p">(</span><span class="mi">31</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">signal</span> <span class="n">value</span>    <span class="o">:</span> <span class="kt">unsigned</span><span class="p">(</span><span class="mi">15</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">axi_reg</span>         <span class="o">&lt;=</span> <span class="n">resize</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">axi_reg</span><span class="na">&#39;length</span><span class="p">);</span> 
<span class="c1">-- the same principle applies if the signals&#39; types are different, </span>
<span class="c1">-- you just have to go through some casts to use resize and assign</span>
</pre></div>
</div>
<p>The use of the <strong>(others =&gt; )</strong> syntax also is very useful so as you assign values to a whole signal without having to specify any size.</p>
<div class="highlight-vhdl notranslate"><div class="highlight"><pre><span></span><span class="k">type</span> <span class="n">t_tab_slv</span>  <span class="k">is</span> <span class="k">array</span> <span class="p">(</span><span class="mi">0</span> <span class="k">to</span> <span class="mi">5</span><span class="p">)</span> <span class="k">of</span> <span class="kt">std_logic_vector</span><span class="p">(</span><span class="mi">7</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>   <span class="c1">-- Table of integers</span>
<span class="k">signal</span> <span class="n">tab_slv</span>  <span class="o">:</span> <span class="n">t_tab_slv</span> <span class="o">:=</span> <span class="p">(</span><span class="k">others</span><span class="o">=&gt;</span><span class="p">(</span><span class="k">others</span><span class="o">=&gt;</span><span class="sc">&#39;0&#39;</span><span class="p">));</span>              <span class="c1">-- Init whole table to 0</span>
<span class="n">tab_slv</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="o">&lt;=</span> <span class="p">(</span><span class="k">others</span> <span class="o">=&gt;</span> <span class="sc">&#39;1&#39;</span><span class="p">);</span>  <span class="c1">-- All bits of first vector in table to 1 </span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="resources.html" class="btn btn-neutral float-right" title="Boards resources" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="dev_tools.html" class="btn btn-neutral float-left" title="Development tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, R. Beaubois.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>